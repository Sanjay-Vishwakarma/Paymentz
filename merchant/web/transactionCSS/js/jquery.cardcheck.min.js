/*!
 * jQuery.cardcheck
 * A plugin for detecting and validating credit cards
 * 
 * https://github.com/unruthless/jQuery.cardcheck
 * 
 * Copyright (c) 2010 Ruthie BenDor and Tim Branyen
 * Dual licensed under the MIT and GPL licenses.
 * 
 */
(function(b,a,c){var d;c.cardcheck=function(h){var i=d.types||[],f=(typeof h==="string")?h:h.num,e=f.length,g,k=false,j=false;c.each(i,function(m,l){if(l.checkType(f)){g=m;return false}});if(f&&i&&i[g]){k=i[g].checkLength(e);j=d.checkLuhn(f)}return{type:g,validLen:k,validLuhn:j}};c.fn.cardcheck=function(f){if(f&&c.isFunction(f)){var e=c({},d);e.callback=f;f=e}else{f=c.extend({},d,f)}return this.bind("keyup",function(){var k=f.types||{},i=this.value.replace(/\D+/g,""),h="",j="",g=c.cardcheck({num:i});if(typeof g.type==="number"){h=k[g.type].name;j=k[g.type].className}f.callback.call(this,{num:i,len:i.length,cardName:h,cardClass:j,validLen:g.validLen,validLuhn:g.validLuhn,opts:f})})};d=c.fn.cardcheck.opts={checkLuhn:function(f){var e=f.length;if(!f||!e){return false}f=f.split("").reverse();var h=0,g;for(g=0;g<e;g++){f[g]=b.parseInt(f[g],10);h+=g%2?2*f[g]-(f[g]>4?9:0):f[g]}return h%10===0},types:[{name:"Visa",className:"visa",checkType:function(e){return e.charAt(0)==="4"},checkLength:function(e){return e===13||e===16||e===19}},{name:"American Express",className:"amex",checkType:function(e){return e.substr(0,2)==="34"||e.substr(0,2)==="37"},checkLength:function(e){return e===15}},{name:"MasterCard",className:"mastercard",checkType:function(e){if(e.charAt(0)==="5"){return e.charAt(1)>=1&&e.charAt(1)<=5}else{if(e.charAt(0)==="2"){return e.charAt(1)>=2&&e.charAt(1)<=7}}return false},checkLength:function(e){return e===16||e===19}},{name:"Discover",className:"discover",checkType:function(e){if(e.charAt(0)==="6"){return e.substr(0,2)==="65"||e.substr(0,4)==="6011"||e.substr(0,3)==="622"||e.substr(0,3)==="644"||e.substr(0,3)==="645"||e.substr(0,3)==="646"||e.substr(0,3)==="647"||e.substr(0,3)==="648"||e.substr(0,3)==="649"}return false},checkLength:function(e){return e===16||e===19}},{name:"JCB",className:"jcb",checkType:function(e){return e.substr(0,2)==="35"},checkLength:function(e){return e===16||e===19}},{name:"Diners Club",className:"diners",checkType:function(e){return e.substr(0,3)==="300"||e.substr(0,3)==="301"||e.substr(0,3)==="302"||e.substr(0,3)==="303"||e.substr(0,3)==="304"||e.substr(0,3)==="305"||e.substr(0,2)==="36"||e.substr(0,2)==="54"||e.substr(0,2)==="55"||e.substr(0,2)==="38"},checkLength:function(e){return e===14||e===16}},{name:"Maestro",className:"maestro",checkType:function(e){return e.substr(0,4)==="5018"||e.substr(0,4)==="5020"||e.substr(0,4)==="5038"||e.substr(0,4)==="5893"||e.substr(0,4)==="6304"||e.substr(0,4)==="6759"||e.substr(0,4)==="6761"||e.substr(0,4)==="6762"||e.substr(0,4)==="6763"||e.substr(0,4)==="6709"||e.substr(0,4)==="6799"||e.substr(0,4)==="6705"},checkLength:function(e){return e===16||e===19}},{name:"Rupay",className:"rupay",checkType:function(e){return e.substr(0,2)==="60"||e.substr(0,4)==="6521"||e.substr(0,4)==="6522"},checkLength:function(e){return e===16}}],callback:c.noop}})(this,this.document,this.jQuery);