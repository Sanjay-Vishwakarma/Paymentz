<%@ page import="com.directi.pg.Functions" %>
<%@ page import="com.directi.pg.Logger" %>
<%@ page import="com.manager.enums.Currency"%>
<%@ page import="net.partner.PartnerFunctions" %>
<%@ page import="org.owasp.esapi.ESAPI" %>
<%@ page import="java.math.BigDecimal" %>
<%@ page import="java.util.Enumeration" %>
<%@ page import="java.util.Hashtable" %>
<%@ page import="java.util.LinkedHashMap" %>
<%@ page import="java.util.TreeMap" %>
<%@ include file="top.jsp" %>
<%
    String company = ESAPI.encoder().encodeForHTML((String)session.getAttribute("partnername"));
    session.setAttribute("submit","MemberMappingDetails");
    Functions functions = new Functions();
%>
<%!
    private static Logger log=new Logger("membermappingpreference.jsp");
%>
<html>
<head>
    <script src="/partner/NewCss/am_multipleselection/bootstrap-multiselect.js"></script>
    <link href="/partner/NewCss/am_multipleselection/bootstrap-multiselect.css" rel="stylesheet" />
    <style type="text/css">
        #maintitle{
            text-align: center;
            background: #7eccad;
            color: #fff;
            font-size: 14px;
        }

        @media(min-width: 640px){
            #saveid{
                position: absolute;
                background: #F9F9F9!important;
            }

            #savetable{
                padding-bottom: 25px;
            }

            table.table{
                margin-bottom: 6px !important;
            }

            table#savetable td:before{
                font-size: inherit;
            }
        }

        table#savetable td:before{
            font-size: 13px;
            font-family: Open Sans;
        }

        table.table{
            margin-bottom: 0px !important;
        }

        #saveid input{
            font-size: 16px;
            padding-right: 30px;
            padding-left: 30px;
        }


        .multiselect {
            width: 100%;

        }

        .selectBox {
            position: relative;
        }

        .selectBox select {
            width: 100%;
            font-weight: bold;
        }

        .overSelect {
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
        }

        #checkboxes {
            display: none;
            border: 1px #dadada solid;

            position: absolute;
            width: 92%;
            background-color: #ffffff;
            z-index: 1;
            height: 200px;
            overflow-x: auto;
        }

        #checkboxes label {
            display: block;
        }

        #checkboxes label:hover {
            background-color: #1e90ff;
        }


        input[type="checkbox"]{
            width: 18px; /*Desired width*/
            height: 18px; /*Desired height*/
        }
        #checkboxes {
            display: none;
            border: 1px #dadada solid;
            position: absolute;
            width: 100%;
            background-color: #ffffff;
            z-index: 1;
            height: 130px;
            overflow-x: auto;
        }

        #checkboxes label {
            display: block;
        }

        #checkboxes label:hover {
            background-color: #1e90ff;
        }

        input[type="checkbox"]{
            width: 18px; /*Desired width*/
            height: 18px; /*Desired height*/
        }
        .icheckbox_square-aero{
            margin: 3px 5px;
        }

        /********************************************************************************/

        .multiselect-container>li {
            padding: 0;
            margin-left: 31px;
        }
        .open>#multiselect-id.dropdown-menu {
            display: block;
            overflow-y: scroll;
            padding-top: 5px;
        }
        .multiselect-container>li>a>label {
            margin: 0;
            height: 24px;
            padding-left:1px; !important;
            text-align: left;
        }
        span.multiselect-native-select {
            position: relative;
        }

        @supports (-ms-ime-align:auto) {
            span.multiselect-native-select {
                position: static!important;
            }
        }

        select[multiple], select[size] {
            height: auto;
            border-color: rgb(169, 169, 169);
        }
        .widget .btn-group {
            z-index: 1;
        }

        .btn-group, .btn-group-vertical {
            position: relative;
            vertical-align: middle;
            border-radius: 4px;
            width:100%;
            height: 34px;
            background-color: #fff;
        }
        #mainbtn-id.btn-default {
            color: #333;
            background-color: #fff;
            padding: 6px;
            border: 1px solid #b2b2b2;
            height: 100%;
        }
        .btn-group>.btn:first-child {
            margin-left: 0;
        }

        .btn-group>.btn:first-child {
            margin-left: 0;
        }

        .btn-group>.btn, .btn-group-vertical>.btn {
            position: relative;
            float: left;
        }
        .multiselect-container {
            position: absolute;
            list-style-type: none;
            margin: 0;
            padding: 0;
        }
        #multiselect-id.dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            z-index: 1;
            display: none;
            float: left;
            min-width: 100%;
            font-size: 14px;
            font-family: "Open Sans","Helvetica Neue",Helvetica,Arial,sans-serif;
            list-style: none;
            background-color: #fff;
            border: 1px solid #ccc;
            border: 1px solid rgba(0,0,0,0.15);
            border-radius: 4px;
            -webkit-box-shadow: 0 6px 12px rgba(0,0,0,0.175);
            box-shadow: 0 6px 12px rgba(0,0,0,0.175);
            background-clip: padding-box;
        }
        #mainbtn-id .multiselect-selected-text{
            font-size: 12px;
            font: inherit;
            font-weight: bold;
        }
        #mainbtn-id.btn-default, #mainbtn-id.btn-default:focus, #mainbtn-id.btn-default.focus, #mainbtn-id.btn-default:active, #mainbtn-id.btn-default.active, .open>.dropdown-toggle#mainbtn-id.btn-default {
            color: #333;
            /*color: #fff;*/
            background-color: white!important;
            text-align: left;
            width: 100%;
        }
        .tr1 .multiselect-native-select .btn-group #mainbtn-id .multiselect-selected-text , .tr0 .multiselect-native-select .btn-group #mainbtn-id .multiselect-selected-text
        {
            font-size: 13px;
            font: inherit;
        }
        .tr1 .multiselect-native-select .btn-group #mainbtn-id , .tr0 .multiselect-native-select .btn-group #mainbtn-id
        {
            width: 220px; !important;
        }
        .btn .caret {
            display: inline-block;!important;
            width: 0px;!important;
            height: 1px;!important;
            margin-left: 2px;!important;
            vertical-align: middle;!important;
            border-top: 7px solid;!important;
            border-right: 4px solid transparent;!important;
            border-left: 4px solid transparent;!important;
            float: right;!important;
            margin-top: 5px;!important;
        }
        #mainbtn-id
        {
            overflow: hidden;
            display: block;
        }
    </style>

</head>
<title><%=company%> Merchant Account Mapping</title>
<body>

<%
    PartnerFunctions partnerFunctions=new PartnerFunctions();
    ctoken = ((User)session.getAttribute("ESAPIUserSessionKey")).getCSRFToken();
    String str="";
    if (partner.isLoggedInPartner(session))
    {
        LinkedHashMap<Integer,String> memberidDetails= partner.getPartnerMembersDetail(String.valueOf(session.getAttribute("merchantid")));
        String cardtypeid = request.getParameter("cardtypeid");
        String paymodeid = request.getParameter("paymodeid");
        String memberid=nullToStr(request.getParameter("memberid"));
        String accountid=nullToStr(request.getParameter("accountid"));
        if (memberid != null) str = str + "&memberid=" + memberid;
%>
<script type="text/javascript">
    $(function ()
    {
        $('#whitelisting').multiselect({
            buttonText: function (options, select)
            {
                var labels = [];
                if (options.length === 0)
                {
                    labels.pop();
                    document.getElementById('whitelistcode').value = labels;
                    return 'Select Whitelist Details';
                }
                else
                {
                    options.each(function ()
                    {
                        labels.push($(this).val());
                    });
                    document.getElementById('whitelistcode').value = labels;
                    return labels.join(', ') + '';
                }
            }
        });
    });
</script>
<script type="text/javascript">
    function check()
    {
        var error = ""
        var memberid = form1.elements["memberid"].value;
        var accountid = form1.elements["accountid"].value;
        var paymodeid = form1.elements["paymodeid"].value;
        var checkboxes = $("#chkbox").find("input")
        var total_boxes = checkboxes.length;
        var flag,i;
        for(i=0; i<total_boxes; i++ )
        {
            if(checkboxes[i].checked)
            {
                flag= true;
                break;
            }
            else
            {
                flag= false;
            }

        }
        if (memberid == "") {
            error += "Select MemberId \n";
        }
        if (accountid == "") {
            error += "Select Bank Account\n";
        }
        if (paymodeid == "") {
            error += "Select PayMode\n";
        }
        if(flag == false)
        {
            error += "Select At Least One CardType \n";
        }
        if (error != "") {
            window.alert(error);
        } else {
            document.getElementById("form1").submit();
        }
    }

    function confirmsubmit(i) {
        var r = window.confirm("Are You Sure you want to Update The Details");
        if (r == true) {
            document.getElementById("charges" + i).submit();
        } else {

        }
    }

    function confirmsubmit2(i) {
        if (document.getElementById("action" + i).value == "DELETE") {
            var r = window.confirm("Are You Sure you want to Delete The Mapping");
            if (r == true) {
                document.getElementById("details" + i).submit();
            } else {

            }
        } else {
            document.getElementById("details" + i).submit();
        }
    }

    function confirmgateway() {
        if (form1.elements["accountid"].value == "") {
            window.alert("Please Select Account ID");
        } else {
            var accountid = form1.elements["accountid"].value;
            window.open('GetGatewayAccount?accountid=' + accountid + '&ctoken=<%=user.getCSRFToken()%>', 'newwindow', 'width=500, height=350');
            return false;
        }
    }
</script>

<script>
    var expanded = false;

    function showCheckboxes() {
        var checkboxes = document.getElementById("checkboxes");
        if (!expanded) {
            checkboxes.style.display = "block";
            expanded = true;
        } else {
            checkboxes.style.display = "none";
            expanded = false;
        }
    }

</script>


<div class="content-page">
    <div class="content">
        <!-- Page Heading Start -->
        <div class="page-heading">

            <form id="form1" name=form1 action="SetAccount?ctoken=<%=ctoken%>" method="POST">
                <div class="row reporttable">
                    <div class="col-sm-12 portlets ui-sortable">

                        <div class="widget">

                            <%
                                String errormsg2 = (String) request.getAttribute("error1");
                                String errormsg1 = (String) request.getAttribute("error");
                                String success = (String) request.getAttribute("success1");

                                if (functions.isValueNull(errormsg2))
                                {
                                    out.println("<h5 class=\"bg-infoorange\" style=\"text-align: center;\"><i class=\"fa fa-exclamation-triangle\"></i>&nbsp;&nbsp;" + errormsg2 + "</h5>");
                                }
                                if (functions.isValueNull(errormsg1))
                                {
                                    out.println("<h5 class=\"bg-infoorange\" style=\"text-align: center;\"><i class=\"fa fa-exclamation-triangle\"></i>&nbsp;&nbsp;" + errormsg1 + "</h5>");
                                }

                                if (functions.isValueNull(success))
                                {
                                    out.println("<h5 class=\"bg-info\" style=\"text-align: center;\"><i class=\"fa fa-exclamation-triangle\"></i>&nbsp;&nbsp;" + success + "</h5>");
                                }

                            %>

                            <div class="widget-header transparent">
                                <h2><strong><i class="fa fa-th-large"></i>&nbsp;&nbsp;Merchant Account Mapping</strong></h2>
                                <div class="additional-btn">
                                    <a href="#" class="hidden reload"><i class="icon-ccw-1"></i></a>
                                    <a href="#" class="widget-toggle"><i class="icon-down-open-2"></i></a>
                                    <a href="#" class="widget-close"><i class="icon-cancel-3"></i></a>
                                </div>
                            </div>

                            <div class="widget-content padding">
                                <div id="horizontal-form">
                                    <div class="widget-header transparent">
                                        <h2 id="maintitle"><strong>&nbsp;&nbsp;Create Account</strong></h2>
                                    </div>
                                    <br>
                                    <div class="form-group col-md-4 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Merchant ID</label>
                                        <select class="form-control" name="memberid" style="border: 1px solid #b2b2b2;font-weight:bold">
                                            <option value="" default>Select Merchant Id</option>
                                            <%
                                                for(Integer mid : memberidDetails.keySet())
                                                {

                                            %>
                                            <option value="<%=mid%>" ><%=mid+"-"+memberidDetails.get(mid)%></option>
                                            <%
                                                }
                                            %>
                                        </select>
                                    </div>
                                    <div class="form-group col-md-4 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Bank Account</label>
                                        <select class="form-control" id="accountid" name="accountid" style="border: 1px solid #b2b2b2;font-weight:bold">
                                            <option  default>Select Bank Account</option>
                                            <%
                                                TreeMap<Integer,String> accountMap= (TreeMap) request.getAttribute("accountids");
                                                for(Integer accID:accountMap.keySet())
                                                {
                                            %>
                                            <option > <%=accID%>-<%=accountMap.get(accID)%></option>
                                            <%
                                                }
                                            %>
                                        </select>
                                    </div>
                                    <div class="form-group col-md-4 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">PayMode</label>
                                        <select class="form-control" id="paymodeid" name="paymodeid" style="border: 1px solid #b2b2b2;font-weight:bold">
                                            <option value="" default>Select PayMode</option>
                                            <%
                                                TreeMap<String,Integer> paymap= (TreeMap) request.getAttribute("paymodeids");
                                                for(String paymode:paymap.keySet())
                                                {
                                            %>
                                            <option value="<%=paymap.get(paymode)%>"> <%=paymode%></option>
                                            <%
                                                }
                                            %>
                                        </select>
                                    </div>


                                    <div class="form-group col-md-4 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">CardType</label>
                                        <div class="multiselect">
                                            <div class="selectBox" onclick="showCheckboxes()">
                                                <select class="form-control" id="cardtypeid" name="cardtypeid" style="border: 1px solid #b2b2b2;font-weight:bold ">
                                                    <option>Select CardType</option>
                                                </select>
                                                <div class="overSelect"></div>
                                            </div>
                                            <div id="checkboxes">
                                                <div id="chkbox" align="left" class="checkboxes"  style="padding-left: 15px; padding-top: 5px ">
                                                    <%
                                                        TreeMap<String,Integer> cardmap= (TreeMap) request.getAttribute("cardtypeids");

                                                        for(String cardtype:cardmap.keySet())
                                                        {
                                                    %>
                                                    <input type="checkbox"  name="cardtype_<%=cardmap.get(cardtype)%>" align="left" value="<%=cardmap.get(cardtype)%>"> <%=cardtype%> <br>

                                                    <%

                                                        }
                                                    %>

                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="widget-header transparent">
                                        <h2 id="maintitle"><strong>&nbsp;&nbsp;Limits</strong></h2>
                                    </div>
                                    <br>

                                    <div class="form-group col-md-2 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Daily Amount Limit</label>
                                        <input type="text" class="form-control" size=10 name='daily_amount_limit' style="border: 1px solid #b2b2b2;font-weight:bold" value="100.00" />
                                    </div>
                                    <div class="form-group col-md-2 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Weekly Amount Limit</label>
                                        <input type="text" class="form-control" size=10 name='weekly_amount_limit' style="border: 1px solid #b2b2b2;font-weight:bold" value="100.00" />
                                    </div>
                                    <div class="form-group col-md-2 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Monthly Amount Limit</label>
                                        <input type="text" class="form-control" size=10 name='monthly_amount_limit' style="border: 1px solid #b2b2b2;font-weight:bold" value="100.00" />
                                    </div>
                                    <div class="form-group col-md-2 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Daily Card Limit</label>
                                        <input type="text" class="form-control" size=10 name='daily_card_limit' style="border: 1px solid #b2b2b2;font-weight:bold" value="5" />
                                    </div>
                                    <div class="form-group col-md-2 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Weekly Card Limit</label>
                                        <input type="text" class="form-control" size=10 name='weekly_card_limit' style="border: 1px solid #b2b2b2;font-weight:bold" value="10" />
                                    </div>
                                    <div class="form-group col-md-2 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Monthly Card Limit</label>
                                        <input type="text" class="form-control" size=10 name='monthly_card_limit' style="border: 1px solid #b2b2b2;font-weight:bold" value="20" />
                                    </div>

                                    <div class="form-group col-md-3 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight:600;">Daily Card Amount Limit</label>
                                        <input type="text" class="form-control" size=10 name='daily_card_amount_limit' style="border: 1px solid #b2b2b2;font-weight:bold" value="1000.00" />
                                    </div>
                                    <div class="form-group col-md-3 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Weekly Card Amount Limit</label>
                                        <input type="text" class="form-control" size=10 name='weekly_card_amount_limit' style="border: 1px solid #b2b2b2;font-weight:bold" value="5000.00" />
                                    </div>
                                    <div class="form-group col-md-3 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Monthly Card Amount Limit</label>
                                        <input type="text" class="form-control" size=10 name='monthly_card_amount_limit' style="border: 1px solid #b2b2b2;font-weight:bold" value="10000.00" />
                                    </div>
                                    <div class="form-group col-md-3 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Daily Avg Ticket</label>
                                        <input type="text" class="form-control" size=10 name='daily_avg_ticket' style="border: 1px solid #b2b2b2;font-weight:bold" value="150.00" />
                                    </div>
                                    <div class="form-group col-md-2 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Weekly Avg Ticket</label>
                                        <input type="text" class="form-control" size=10 name='weekly_avg_ticket' style="border: 1px solid #b2b2b2;font-weight:bold" value="150.00" />
                                    </div>
                                    <div class="form-group col-md-3 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Monthly Avg Ticket</label>
                                        <input type="text" class="form-control" size=10 name='monthly_avg_ticket' style="border: 1px solid #b2b2b2;font-weight:bold" value="150.00" />
                                    </div>

                                    <div class="form-group col-md-3 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Min Transaction Amount</label>
                                        <input type="text" class="form-control" size=10 name='min_trans_amount' style="border: 1px solid #b2b2b2;font-weight:bold" value="50.00" />
                                    </div>
                                    <div class="form-group col-md-3 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Max Transaction Amount</label>
                                        <input type="text" class="form-control" size=10 name='max_trans_amount' style="border: 1px solid #b2b2b2;font-weight:bold" value="1000.00" />
                                    </div>

                                    <div class="widget-header transparent">
                                        <h2 id="maintitle"><strong>&nbsp;&nbsp;Others</strong></h2>
                                    </div>
                                    <br>

                                    <div class="form-group col-md-3 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;display: inline;">IsActive</label>
                                        <select class="form-control" name='isActive' style="border: 1px solid #b2b2b2;font-weight:bold">
                                            <%out.println(partnerFunctions.comboval(ESAPI.encoder().encodeForHTMLAttribute("Y")));%>
                                        </select>
                                    </div>

                                    <div class="form-group col-md-3">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;display: inline;">Priority</label>
                                        <select class="form-control" id="priority" name="priority" style="border: 1px solid #b2b2b2;font-weight:bold">
                                            <option value="1" default>1</option>
                                            <option value="2" default>2</option>
                                            <option value="3" default>3</option>
                                            <option value="4" default>4</option>
                                            <option value="5" default>5</option>
                                        </select>
                                    </div>

                                    <div class="form-group col-md-3 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;display: inline;">IsTest</label>
                                        <select class="form-control" name='isTest' style="border: 1px solid #b2b2b2;font-weight:bold">
                                            <%out.println(partnerFunctions.comboval(ESAPI.encoder().encodeForHTMLAttribute("N")));%>
                                        </select>
                                    </div>

                                    <div class="form-group col-md-3 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;display: inline;">Is PSTTerminal</label>
                                        <select class="form-control" name='isPSTTerminal' style="border: 1px solid #b2b2b2;font-weight:bold">
                                            <%out.println(partnerFunctions.comboval(ESAPI.encoder().encodeForHTMLAttribute("N")));%>
                                        </select>
                                    </div>

                                    <div class="form-group col-md-3 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;display: inline;">Is TokenizationActive</label>
                                        <select class="form-control" name='isTokenizationActive' style="border: 1px solid #b2b2b2;font-weight:bold"><%out.println(partnerFunctions.comboval(ESAPI.encoder().encodeForHTMLAttribute("N")));%></select>
                                    </div>

                                    <div class="form-group col-md-3">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;display: inline;">Address Details</label>
                                        <select name='addressDetails' class="form-control" style="border: 1px solid #b2b2b2;font-weight:bold"><%out.println(partnerFunctions.comboval(ESAPI.encoder().encodeForHTMLAttribute("N")));%></select>
                                    </div>

                                    <div class="form-group col-md-3">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;display: inline;">Address Validation</label>
                                        <select name='addressValidation' class="form-control" style="border: 1px solid #b2b2b2;font-weight:bold"><%out.println(partnerFunctions.comboval(ESAPI.encoder().encodeForHTMLAttribute("N")));%></select>
                                    </div>

                                    <div class="form-group col-md-3">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;display: inline;">Risk Rule Activation</label>
                                        <select name='riskRuleActivation' class="form-control" style="border: 1px solid #b2b2b2;font-weight:bold"><%out.println(partnerFunctions.comboval(ESAPI.encoder().encodeForHTMLAttribute("N")));%></select>
                                    </div>

                                    <div class="form-group col-md-3">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;display: inline;">Min Payout Amount</label>
                                        <input type="text" class="form-control" size=10 name='min_payout_amount' style="border: 1px solid #b2b2b2;font-weight:bold" value="500.00" />
                                    </div>

                                    <div class="form-group col-md-3">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;display: inline;">Settlement Currency</label>
                                        <select class="form-control" size="1" name='settlement_currency'style="border: 1px solid #b2b2b2;font-weight:bold">
                                            <%
                                                for (Currency settlementCurrency:Currency.values())
                                                {
                                                    out.println("<option value=\""+settlementCurrency.toString()+"\">"+settlementCurrency.toString()+"</option>");
                                                }
                                            %>
                                        </select>

                                    </div>

                                    <div class="form-group col-md-3">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;display: inline;">Is Bin Routing</label>
                                        <select name='bin_routing' class="form-control" style="border: 1px solid #b2b2b2;font-weight:bold"><%out.println(partnerFunctions.comboval(ESAPI.encoder().encodeForHTMLAttribute("N")));%></select>
                                    </div>
                                    <div class="form-group col-md-3">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;display: inline;">Is Card Whitelisted</label>
                                        <select name='isCardWhitelisted' class="form-control" style="border: 1px solid #b2b2b2;font-weight:bold"><%out.println(functions.comboval2(ESAPI.encoder().encodeForHTMLAttribute("N")));%></select>
                                    </div>
                                    <div class="form-group col-md-3">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;display: inline;">Is Email Whitelisted</label>
                                        <select name='isEmailWhitelisted' class="form-control" style="border: 1px solid #b2b2b2;font-weight:bold"><%out.println(functions.comboval2(ESAPI.encoder().encodeForHTMLAttribute("N")));%></select>
                                    </div>
                                    <div class="form-group col-md-3">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;display: inline;">Emi Support </label>
                                        <select name='emi_support' class="form-control" style="border: 1px solid #b2b2b2;font-weight:bold"><%out.println(partnerFunctions.comboval(ESAPI.encoder().encodeForHTMLAttribute("N")));%></select>
                                    </div>
                                    <div class="form-group col-md-3">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;display: inline;">Whitelist Details</label>
                                        <div class="form-group col-md-12 has-feedback" style="padding: 0;">
                                        <select id="whitelisting" class="form-group"  multiple="multiple">
                                            <option value="-1" disabled>Select Whitelist Details</option>
                                            <option value="name">Card Holder Name</option>
                                            <option value="ipAddress">IP Address</option>
                                            <option value="expiryDate">Expiry Date</option>
                                        </select>
                                        </div>
                                        <input type="hidden" id="whitelistcode" name="whitelistdetails" value="">
                                </div>
                                <div class="form-group col-md-12 has-feedback">
                                    <center>
                                        <label>&nbsp;</label>
                                        <input type="hidden" name="action" value="CREATE">
                                        <button align=center type="button" onclick="check()" value="CREATE" class="btn btn-default" style="display: -webkit-box;">CREATE</button>
                                    </center>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
            <div class="row">
                <div class="col-sm-12 portlets ui-sortable">
                    <div class="widget">
                        <div class="widget-header transparent">
                            <h2><strong><i class="fa fa-th-large"></i>&nbsp;&nbsp;Search</strong></h2>
                            <div class="additional-btn">
                                <a href="#" class="hidden reload"><i class="icon-ccw-1"></i></a>
                                <a href="#" class="widget-toggle"><i class="icon-down-open-2"></i></a>
                                <a href="#" class="widget-close"><i class="icon-cancel-3"></i></a>
                            </div>
                        </div>
                        <form action="MemberMappingDetails?ctoken=<%=ctoken%>" method="post" name="F1" onsubmit="">
                            <input type="hidden" value="<%=ctoken%>" name="ctoken">
                            <div class="widget-content padding">
                                <div id="horizontal-form">

                                    <div class="form-group col-md-4 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Merchant ID*</label>
                                        <select class="form-control" size="1" name="memberid" style="border: 1px solid #b2b2b2;font-weight:bold">
                                            <option value="" selected>Select Merchant Id</option>
                                            <%
                                                for(Integer mid : memberidDetails.keySet())
                                                {
                                                    String isSelected1="";

                                                    String contactName = memberidDetails.get(mid);
                                                    if(String.valueOf(mid).equalsIgnoreCase(memberid))
                                                    {

                                                        isSelected1="selected";

                                                    }

                                            %>
                                            <option value="<%=mid%>" <%=isSelected1%>><%=mid+"-"+contactName%></option>
                                            <%
                                                }
                                            %>
                                        </select>
                                    </div>

                                    <div class="form-group col-md-4 has-feedback">
                                        <label style="font-family:Open Sans;font-size: 13px;font-weight: 600;">Bank Account</label>
                                        <select class="form-control" name="accountid" style="border: 1px solid #b2b2b2;font-weight:bold">
                                            <option value="">All</option>
                                            <%

                                                TreeMap<Integer,String> accountMap1= (TreeMap) request.getAttribute("accountids");
                                                for(Integer accID:accountMap1.keySet())
                                                {
                                                    String Selected="";
                                                    if(String.valueOf(accID).equalsIgnoreCase(accountid))
                                                    {
                                                        Selected="selected";
                                                    }

                                            %>
                                            <option value="<%=accID%>" <%=Selected%>> <%=accID%>-<%=accountMap1.get(accID)%>
                                            </option>
                                            <% } %>
                                        </select>
                                    </div>
                                    <div class="form-group col-md-12 has-feedback">
                                        <center>
                                            <label >&nbsp;</label>
                                            <button type="submit" class="btn btn-default" id="submit" style="display: -webkit-box;"><i class="fa fa-clock-o"></i>&nbsp;&nbsp;Search</button>
                                        </center>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <%
                Hashtable  hash = (Hashtable) request.getAttribute("memberdetails");
                Hashtable temphash = null;
                int records = 0;
                int totalrecords = 0;
                try
                {
                    records = Integer.parseInt((String) hash.get("records"));
                    totalrecords = Integer.parseInt((String) hash.get("totalrecords"));
                }
                catch (Exception e)
                {
                    log.error("Records & TotalRecords is found null");
                }
                if(totalrecords>0)
                {
            %>
            <div class="row reporttable">
                <div class="col-md-12">
                    <div class="widget">
                        <div class="widget-header">
                            <h2><i class="fa fa-table"></i>&nbsp;&nbsp;<strong>Merchant Account Reports</strong></h2>
                            <div class="additional-btn">
                                <a href="#" class="hidden reload"><i class="icon-ccw-1"></i></a>
                                <a href="#" class="widget-toggle"><i class="icon-down-open-2"></i></a>
                                <a href="#" class="widget-close"><i class="icon-cancel-3"></i></a>
                            </div>
                        </div>
                        <% String style = "td1";
                            for (int pos = 1; pos <= records; pos++)
                            {
                                String id = Integer.toString(pos);
                                int srno = Integer.parseInt(id) ;

                                if (pos % 2 == 0)
                                    style = "tr0";
                                else
                                    style = "tr1";
                                temphash = null;
                                temphash = (Hashtable) hash.get(id);

                                String memberId = (String) temphash.get("memberid");
                                String accountId = PartnerFunctions.checkStringNull((String) temphash.get("accountid"));

                                paymodeid = "N/A";
                                cardtypeid = "N/A";
                                String monthly_amount_limit = "N/A";
                                String weekly_amount_limit = "N/A";
                                String daily_card_limit = "N/A";
                                String weekly_card_limit = "N/A";
                                String monthly_card_limit = "N/A";
                                String daily_amount_limit = "N/A";
                                String isReadOnly = "readonly";
                                String daily_card_amount_limit="",weekly_card_amount_limit="",monthly_card_amount_limit="",min_trans_amount="",max_trans_amount="",isActive="",priority="",isTest="",isPSTTerminal="",isTokenizationActive="",isCardEncryptionEnable="",terminalid="",daily_avg_ticket="150.00",weekly_avg_ticket="150.00",monthly_avg_ticket="150.00",addressDetails="",addressValidation="",riskRuleActivation="",min_payout_amount="",settlementCurrency="",bin_routing="",isCardWhitelisted="",isEmailWhitelisted="",emi_support="",whitelisting="";
                                if (accountId != null)
                                {
                                    isReadOnly = "";
                                    paymodeid = ((String) temphash.get("paymodeid"));
                                    cardtypeid = ((String) temphash.get("cardtypeid"));
                                    monthly_amount_limit =(new BigDecimal((String) temphash.get("monthly_amount_limit"))).toString();
                                    weekly_amount_limit = (new BigDecimal((String) temphash.get("weekly_amount_limit"))).toString();
                                    daily_amount_limit = (new BigDecimal((String) temphash.get("daily_amount_limit"))).toString();
                                    daily_card_limit = (new BigDecimal((String) temphash.get("daily_card_limit"))).toString();
                                    weekly_card_limit = (new BigDecimal((String) temphash.get("weekly_card_limit"))).toString();
                                    monthly_card_limit = (new BigDecimal((String) temphash.get("monthly_card_limit"))).toString();

                                    daily_card_amount_limit = (new BigDecimal((String) temphash.get("daily_card_amount_limit"))).toString();
                                    weekly_card_amount_limit  = (new BigDecimal((String) temphash.get("weekly_card_amount_limit"))).toString();
                                    monthly_card_amount_limit = (new BigDecimal((String) temphash.get("monthly_card_amount_limit"))).toString();

                                    min_trans_amount = (new BigDecimal((String) temphash.get("min_transaction_amount"))).toString();
                                    max_trans_amount = (new BigDecimal((String) temphash.get("max_transaction_amount"))).toString();

                                    daily_avg_ticket = (new BigDecimal((String) temphash.get("daily_avg_ticket"))).toString();
                                    weekly_avg_ticket = (new BigDecimal((String) temphash.get("weekly_avg_ticket"))).toString();
                                    monthly_avg_ticket = (new BigDecimal((String) temphash.get("monthly_avg_ticket"))).toString();
                                    min_payout_amount = (new BigDecimal((String) temphash.get("min_payout_amount"))).toString();
                                    settlementCurrency = (String) temphash.get("settlement_currency");

                                    isActive = (String) temphash.get("isActive");
                                    priority = (String) temphash.get("priority");
                                    isTest =  (String) temphash.get("isTest");
                                    isPSTTerminal =  (String) temphash.get("isPSTTerminal");
                                    isTokenizationActive = (String) temphash.get("isTokenizationActive");
                                    addressDetails = (String) temphash.get("addressDetails");
                                    addressValidation = (String) temphash.get("addressValidation");
                                    riskRuleActivation = (String) temphash.get("riskruleactivation");
                                    terminalid = (String) temphash.get("terminalid");
                                    bin_routing = (String) temphash.get("binRouting");
                                    isCardWhitelisted= (String) temphash.get("isCardWhitelisted");
                                    isEmailWhitelisted= (String) temphash.get("isEmailWhitelisted");
                                    emi_support= (String) temphash.get("emi_support");
                                    whitelisting=(String)temphash.get("whitelisting_details");

                                }
                        %>
                        <div class="widget-content padding" style="overflow-x: auto;">
                            <form id="details<%=pos%>" action="/partner/net/SetAccount?ctoken=<%=ctoken%>" method=post>
                                <input type="hidden" value="<%=ctoken%>" name="ctoken">
                                <input type=hidden value="<%=accountId%>" name="accountid" >
                                <input type=hidden value="<%=terminalid%>" name="terminalid" >
                                <table id="myTable" align=center width="50%" class="display table table table-striped table-bordered table-hover dataTable" style="font-family:Open Sans;font-size: 13px;font-weight: 600;width: 100%;">
                                    <thead>
                                    <tr>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Terminal ID</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Merchant ID</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Account ID</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>PayMode ID</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Card Type ID</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Monthly Amount Limit</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Weekly Amount Limit</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Daily Amount Limit</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Daily Card Limit</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Weekly Card Limit</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Monthly Card Limit</b></td>
                                        <td  <%--colspan="2" --%>valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Action</b></td>
                                    </tr>
                                    </thead>
                                    <tr>
                                        <td valign="middle" data-label="Terminal ID" align="center" style="vertical-align: middle;" class="<%=style%>"><b><%=ESAPI.encoder().encodeForHTMLAttribute(terminalid)%></b></td>
                                        <td valign="middle" data-label="Merchant ID" align="center" class="<%=style%>"><input type=text style="width:100px;" class="form-control" name="memberid" value="<%=ESAPI.encoder().encodeForHTMLAttribute(memberId)%>" readonly></td>
                                        <td valign="middle" data-label="Account ID" align="center" class="<%=style%>"><button type="submit" class="btn btn-default" onclick="window.open('GetGatewayAccount?accountid=<%=ESAPI.encoder().encodeForHTMLAttribute(accountId)%>&ctoken=<%=user.getCSRFToken()%>', 'newwindow', 'width=500, height=350'); return false;"> <%=ESAPI.encoder().encodeForHTMLAttribute(accountId)%></button> </td>
                                        <td valign="middle" data-label="PayMode ID" align="center" class="<%=style%>"><input type=text style="width:100px;" class="form-control" align="center" size=10 name='paymodeid' value="<%=paymodeid%>" readonly></td>
                                        <td valign="middle" data-label="Card Type ID" align="center" class="<%=style%>"><input type=text class="form-control" style="width:100px;"name='cardtypeid' value="<%=ESAPI.encoder().encodeForHTMLAttribute(cardtypeid)%>" readonly></td>
                                        <td valign="middle" data-label="Monthly Amount Limit" align="center" class="<%=style%>"><input type=text class="form-control" style="width:100px;" name='monthly_amount_limit' value="<%=ESAPI.encoder().encodeForHTMLAttribute(monthly_amount_limit)%>" <%=isReadOnly%>></td>
                                        <td valign="middle" data-label="Weekly Amount Limit" align="center" class="<%=style%>"><input type=text class="form-control" style="width:100px;" name='weekly_amount_limit' value="<%=ESAPI.encoder().encodeForHTMLAttribute(weekly_amount_limit)%>" <%=isReadOnly%>></td>
                                        <td valign="middle" data-label="Daily Amount Limit" align="center" class="<%=style%>"><input type=text class="form-control" style="width:100px;" name='daily_amount_limit' value="<%=ESAPI.encoder().encodeForHTMLAttribute(daily_amount_limit)%>" <%=isReadOnly%>></td>
                                        <td valign="middle" data-label="Daily Card Limit" align="center" class="<%=style%>"><input type=text class="form-control" style="width:100px;" name='daily_card_limit' value="<%=ESAPI.encoder().encodeForHTMLAttribute(daily_card_limit)%>" <%=isReadOnly%>></td>
                                        <td valign="middle" data-label="Weekly Card Limit" align="center" class="<%=style%>"><input type=text class="form-control" style="width:100px;" name='weekly_card_limit' value="<%=ESAPI.encoder().encodeForHTMLAttribute(weekly_card_limit)%>" <%=isReadOnly%>></td>
                                        <td valign="middle" data-label="Monthly Card Limit" align="center" class="<%=style%>"><input type=text class="form-control" style="width:100px;" size=10 name='monthly_card_limit' value="<%=ESAPI.encoder().encodeForHTMLAttribute(monthly_card_limit)%>" <%=isReadOnly%>></td>
                                        <td valign="middle" data-label="Action" align="center" class="<%=style%>"><select class="form-control" style="width:inherit" id=action<%=pos%> id="action<%=pos%>" name="action"><option value="UPDATE" default>UPDATE</option><option value="DELETE">DELETE</option> </select></td>
                                    </tr>
                                    <thead>
                                    <tr>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Daily Card Amount Limit</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Weekly Card Amount Limit</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Monthly Card Amount Limit</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Daily Avg Ticket</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Weekly Avg Ticket</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Monthly Avg Ticket</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Min Trans Amount</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Max Trans Amount</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>IsActive</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>Priority</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px;"><b>IsTest</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px; "><b>Is PSTTerminal</b></td>
                                    </tr>
                                    </thead>
                                    <tr>
                                        <td  align="center" data-label="Daily Card Amount Limit" valign="middle" class="<%=style%>"> <input type=text class="form-control" style="width:100px;" size=10 name='daily_card_amount_limit' value="<%=ESAPI.encoder().encodeForHTMLAttribute(daily_card_amount_limit)%>"></td>
                                        <td  align="center" data-label="Weekly Card Amount Limit" valign="middle" class="<%=style%>"> <input type=text class="form-control" style="width:100px;" size=10 name='weekly_card_amount_limit' value="<%=ESAPI.encoder().encodeForHTMLAttribute(weekly_card_amount_limit)%>"></td>
                                        <td  align="center" data-label="Monthly Card Amount Limit" valign="middle" class="<%=style%>"> <input type=text class="form-control" style="width:100px;" size=10 name='monthly_card_amount_limit' value="<%=ESAPI.encoder().encodeForHTMLAttribute(monthly_card_amount_limit)%>"></td>
                                        <td  align="center" data-label="Daily Avg Ticket" valign="middle" class="<%=style%>"> <input type=text class="form-control" style="width:100px;" size=10 name='daily_avg_ticket' value="<%=ESAPI.encoder().encodeForHTMLAttribute(daily_avg_ticket)%>"></td>
                                        <td  align="center" data-label="Weekly Avg Ticket" valign="middle" class="<%=style%>"> <input type=text class="form-control" style="width:100px;" size=10 name='weekly_avg_ticket' value="<%=ESAPI.encoder().encodeForHTMLAttribute(weekly_avg_ticket)%>"></td>
                                        <td  align="center" data-label="Monthly Avg Ticket" valign="middle" class="<%=style%>"> <input type=text class="form-control" style="width:100px;" size=10 name='monthly_avg_ticket' value="<%=ESAPI.encoder().encodeForHTMLAttribute(monthly_avg_ticket)%>"></td>
                                        <td  align="center" data-label="Min Trans Amount" valign="middle" class="<%=style%>"> <input type=text class="form-control" style="width:100px;" size=10 name='min_trans_amount' value="<%=ESAPI.encoder().encodeForHTMLAttribute(min_trans_amount)%>"></td>
                                        <td  align="center" data-label="Max Trans Amount" valign="middle" class="<%=style%>"> <input type=text class="form-control" style="width:100px;" size=10 name='max_trans_amount' value="<%=ESAPI.encoder().encodeForHTMLAttribute(max_trans_amount)%>"></td>
                                        <td  align="center" data-label="IsActive" valign="middle" class="<%=style%>"><select class="form-control" style="width:100px;" name='isActive'><%out.println(PartnerFunctions.comboval(ESAPI.encoder().encodeForHTMLAttribute(isActive)));%></select></td>
                                        <td  align="center" data-label="Priority" valign="middle" class="<%=style%>"><select class="form-control" style="width:100px;" id="priority2" name="priority" >

                                            <%
                                                Hashtable priorityHash=new Hashtable();
                                                priorityHash.put("1","1");
                                                priorityHash.put("2","2");
                                                priorityHash.put("3","3");
                                                priorityHash.put("4","4");
                                                priorityHash.put("5","5");
                                                Enumeration priorityenum=priorityHash.keys();

                                                String isDef="";
                                                String priorityvalue="";
                                                while (priorityenum.hasMoreElements())
                                                {
                                                    priorityvalue=(String)priorityenum.nextElement();

                                                    if((priorityvalue.trim()).equals(ESAPI.encoder().encodeForHTMLAttribute(priority)))
                                                    {
                                                        isDef="selected" ;
                                                    }
                                                    else
                                                    {
                                                        isDef="";
                                                    }
                                            %><option value="<%=ESAPI.encoder().encodeForHTMLAttribute(priorityvalue)%>" <%=isDef%>   >
                                            <%=ESAPI.encoder().encodeForHTML(priorityvalue)%>
                                        </option>
                                            <% } %>
                                        </select>
                                        </td>
                                        <td align="center" data-label="IsTest" valign="middle" class="<%=style%>"><select class="form-control" style="width:100px" name='isTest'><%out.println(PartnerFunctions.comboval(ESAPI.encoder().encodeForHTMLAttribute(isTest)));%></select></td>
                                        <td align="center" data-label="Is PSTTerminal" valign="middle" class="<%=style%>"><select class="form-control" style="width:100px;" name='isPSTTerminal'><%out.println(PartnerFunctions.comboval(ESAPI.encoder().encodeForHTMLAttribute(isPSTTerminal)));%></select></td>
                                    </tr>
                                    <thead>
                                    <tr>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px; "><b>Is TokenizationActive</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px; "><b>Address Details</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px; "><b>Address Validation</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px; "><b>Risk Rule Activation</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px; "><b>Min Payout Amount</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px; "><b>Settlement Currency</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px; "><b>Bin Routing</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px; "><b>Is Card Whitelisted</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px; "><b>Is Email Whitelisted</b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px; "><b>Emi Support </b></td>
                                        <td  valign="middle" align="center" style="background-color: #7eccad !important;color: white;padding-top: 13px;padding-bottom: 13px; "><b>Whitelist Details </b></td>
                                    </tr>
                                    </thead>

                                    <tr>
                                        <td align="center" data-label="Is TokenizationActive" valign="middle" class="<%=style%>"><select class="form-control" style="width:100px;" name='isTokenizationActive'><%out.println(Functions.comboval(ESAPI.encoder().encodeForHTMLAttribute(isTokenizationActive)));%></select></td>
                                        <td align="center" data-label="Address Details" valign="middle" class="<%=style%>"><select class="form-control" style="width:100px" name='addressDetails'><%out.println(Functions.comboval(ESAPI.encoder().encodeForHTMLAttribute(addressDetails)));%></select></td>
                                        <td align="center" data-label="Address Validation" valign="middle" class="<%=style%>"><select class="form-control" style="width:100px" name='addressValidation'><%out.println(Functions.comboval(ESAPI.encoder().encodeForHTMLAttribute(addressValidation)));%></select></td>
                                        <td align="center" data-label="Risk Rule Activation" valign="middle" class="<%=style%>"><select class="form-control" style="width:100px" name='riskRuleActivation'><%out.println(Functions.comboval(ESAPI.encoder().encodeForHTMLAttribute(riskRuleActivation)));%></select></td>
                                        <td valign="middle" data-label="Min Payout Amount" align="center" class="<%=style%>"><input type=text class="form-control" style="width:100px;" name='min_payout_amount' value="<%=ESAPI.encoder().encodeForHTMLAttribute(min_payout_amount)%>" <%=isReadOnly%>></td>
                                        <td align="center" data-label="Settlement Currency" valign="middle" class="<%=style%>">
                                            <select class="form-control" style="width:100px" name='settlement_currency'>
                                                <%
                                                    for(Currency settlementcurrency:Currency.values())
                                                    {
                                                        String selected="";
                                                        if(settlementcurrency.toString().equals(settlementCurrency))
                                                        {
                                                            selected="selected";
                                                        }
                                                        out.println("<option value=\""+settlementcurrency.toString()+"\" "+selected+">"+settlementcurrency.toString()+"</option>");
                                                    }
                                                %>
                                            </select>
                                        </td>
                                        <td align="center" data-label="Bin Routing" valign="middle" class="<%=style%>"><select class="form-control" style="width:100px" name='bin_routing'><%out.println(Functions.comboval(ESAPI.encoder().encodeForHTMLAttribute(bin_routing)));%></select></td>
                                        <td align="center" data-label="Is Card Whitelisted" valign="middle" class="<%=style%>"><select class="form-control" style="width:100px" name='isCardWhitelisted'><%out.println(Functions.comboval2(ESAPI.encoder().encodeForHTMLAttribute(isCardWhitelisted)));%></select></td>
                                        <td align="center" data-label="Is Email Whitelisted" valign="middle" class="<%=style%>"><select class="form-control" style="width:100px" name='isEmailWhitelisted'><%out.println(Functions.comboval2(ESAPI.encoder().encodeForHTMLAttribute(isEmailWhitelisted)));%></select></td>
                                        <td align="center" data-label="Emi Support" valign="middle" class="<%=style%>"><select class="form-control" style="width:100px" name='emi_support'><%out.println(Functions.comboval(ESAPI.encoder().encodeForHTMLAttribute(emi_support)));%></select></td>
                                        <td  align="center" width="100" class="<%=style%>">
                                            <select id="whitelist_<%=pos%>" multiple="multiple"  value="<%=whitelisting%>">
                                                <option class="option_<%=pos%>" value="name">Card Holder Name</option>
                                                <option class="option_<%=pos%>" value="ipAddress">IP Address</option>
                                                <option class="option_<%=pos%>" value="expiryDate">Expiry Date</option>
                                            </select>
                                            <input type="hidden" id="whitelistcode_<%=pos%>" name="whitelistdetails" value="<%=whitelisting%>">
                                            <script>
                                                $(function ()
                                                {
                                                    var value=[];
                                                    var details='<%=whitelisting%>';
                                                    console.log("Details::::"+details);
                                                    value=details.split(",");
                                                    for(var i in value)
                                                    {
                                                       $("#whitelist_<%=pos%> option[value='"+value[i]+"']").prop('selected', true);
                                                    }
                                                    $('#whitelist_<%=pos%>').multiselect({
                                                        buttonText: function (options, select)
                                                        {
                                                            var labels = [];
                                                            if (options.length === 0)
                                                            {
                                                                console.log(" in if");
                                                                labels.pop();
                                                                document.getElementById('whitelistcode_<%=pos%>').value = labels;
                                                                return 'Select Whitelist Details';
                                                            }
                                                            else
                                                            {
                                                                console.log(" in else");
                                                                options.each(function ()
                                                                {
                                                                    labels.push($(this).val());
                                                                });
                                                                console.log("Label::::"+labels);
                                                                document.getElementById('whitelistcode_<%=pos%>').value = labels;
                                                                return labels.join(', ') + '';
                                                            }
                                                        }
                                                    });
                                                });

                                            </script>
                                        </td>
                                    </tr>
                                </table>
                                <table id="savetable">
                                    <tr bgcolor="#FFFFFF" height=50 id="saveid" >
                                        <td valign="middle" data-label="Action" align="center" class="<%=style%>"><input type="button"onclick="confirmsubmit2(<%=pos%>)" class="btn btn-default" value="Save"></td>
                                    </tr>
                                </table>
                                <% if(pos<records){ %>
                            </form>
                        </div>
                        <%
                                    }
                                } //end for
                            }
                        %>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<%
    }
    else
    {
        response.sendRedirect("/partner/logout.jsp");
        return;
    }
%>
</body>
</html>
<%!
    public static String nullToStr(String str)
    {
        if(str == null)
            return "";
        return str;
    }
%>